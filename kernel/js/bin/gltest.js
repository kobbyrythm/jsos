/*
	Copyright (c) 2012 Alexander Overvoorde

	Permission is hereby granted, free of charge, to any person obtaining
	a copy of this software and associated documentation files (the
	"Software"), to deal in the Software without restriction, including
	without limitation the rights to use, copy, modify, merge, publish,
	distribute, sublicense, and/or sell copies of the Software, and to
	permit persons to whom the Software is furnished to do so, subject to
	the following conditions:

	The above copyright notice and this permission notice shall be
	included in all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
	MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
	NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
	LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
	OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
	WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

function loadLibrary( lib, callback )
{
	return OS.stat( lib, function( err, stat ) {
		if ( err ) {
			return callback( false );
		} else {
			return OS.open( lib, function( err, fd ) {
				return OS.read( fd, stat.size, function( err, buff ) {
					OS.loadImage( buff );
					return callback( true );
				} );
			} );
		}
	} );
}

loadLibrary( "/lib/gl.jmg", function( success ) {
	OS.open( "/dev/vga", function( err, vga )
	{
		OS.ioctl( vga, "clear" );
		
		// Set up OpenGL context
		var w = 320;
		var h = 200;
		var gl = new GL.Context( w, h );
		
		gl.enable( GL.TEXTURE_2D );
		gl.enable( GL.DEPTH_TEST );

		gl.clearColor( 0.0, 0.0, 0.0, 1.0 );
		gl.clearDepth( 1.0 );

		// Load grass texture
		var grassTexture = [ 0.451, 0.686, 0.282, 1.000, 0.451, 0.686, 0.282, 1.000, 0.451, 0.686, 0.282, 1.000, 0.376, 0.627, 0.220, 1.000, 0.388, 0.643, 0.231, 1.000, 0.427, 0.675, 0.271, 1.000, 0.345, 0.612, 0.188, 1.000, 0.427, 0.675, 0.271, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.408, 0.659, 0.251, 1.000, 0.408, 0.659, 0.251, 1.000, 0.420, 0.663, 0.263, 1.000, 0.345, 0.596, 0.188, 1.000, 0.345, 0.596, 0.188, 1.000, 0.420, 0.663, 0.263, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.408, 0.659, 0.251, 1.000, 0.408, 0.659, 0.251, 1.000, 0.408, 0.659, 0.251, 1.000, 0.408, 0.659, 0.251, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.420, 0.580, 0.251, 1.000, 0.420, 0.580, 0.251, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.506, 0.200, 1.000, 0.376, 0.643, 0.220, 1.000, 0.690, 0.518, 0.376, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.659, 0.518, 0.376, 1.000, 0.553, 0.424, 0.302, 1.000, 0.553, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.451, 0.686, 0.282, 1.000, 0.451, 0.686, 0.282, 1.000, 0.522, 0.741, 0.345, 1.000, 0.451, 0.686, 0.282, 1.000, 0.471, 0.706, 0.314, 1.000, 0.345, 0.612, 0.188, 1.000, 0.388, 0.643, 0.231, 1.000, 0.388, 0.643, 0.231, 1.000, 0.345, 0.612, 0.188, 1.000, 0.533, 0.753, 0.376, 1.000, 0.533, 0.753, 0.376, 1.000, 0.471, 0.706, 0.314, 1.000, 0.345, 0.596, 0.188, 1.000, 0.420, 0.663, 0.263, 1.000, 0.420, 0.663, 0.263, 1.000, 0.420, 0.663, 0.263, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.408, 0.659, 0.251, 1.000, 0.345, 0.235, 0.157, 1.000, 0.408, 0.659, 0.251, 1.000, 0.408, 0.659, 0.251, 1.000, 0.420, 0.580, 0.251, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.643, 0.220, 1.000, 0.459, 0.329, 0.231, 1.000, 0.576, 0.424, 0.302, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.659, 0.518, 0.376, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.522, 0.741, 0.345, 1.000, 0.596, 0.800, 0.408, 1.000, 0.596, 0.800, 0.408, 1.000, 0.376, 0.627, 0.220, 1.000, 0.388, 0.643, 0.231, 1.000, 0.388, 0.643, 0.231, 1.000, 0.427, 0.675, 0.271, 1.000, 0.427, 0.675, 0.271, 1.000, 0.471, 0.706, 0.314, 1.000, 0.533, 0.753, 0.376, 1.000, 0.533, 0.753, 0.376, 1.000, 0.533, 0.753, 0.376, 1.000, 0.420, 0.663, 0.263, 1.000, 0.345, 0.596, 0.188, 1.000, 0.345, 0.596, 0.188, 1.000, 0.565, 0.800, 0.408, 1.000, 0.471, 0.706, 0.314, 1.000, 0.345, 0.235, 0.188, 1.000, 0.471, 0.706, 0.314, 1.000, 0.471, 0.706, 0.314, 1.000, 0.408, 0.659, 0.251, 1.000, 0.345, 0.235, 0.157, 1.000, 0.408, 0.659, 0.251, 1.000, 0.345, 0.235, 0.157, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.471, 0.737, 0.314, 1.000, 0.376, 0.235, 0.157, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.643, 0.220, 1.000, 0.376, 0.235, 0.157, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.451, 0.686, 0.282, 1.000, 0.427, 0.675, 0.271, 1.000, 0.471, 0.706, 0.314, 1.000, 0.345, 0.612, 0.188, 1.000, 0.345, 0.612, 0.188, 1.000, 0.345, 0.612, 0.188, 1.000, 0.345, 0.612, 0.188, 1.000, 0.408, 0.659, 0.251, 1.000, 0.471, 0.706, 0.314, 1.000, 0.420, 0.663, 0.263, 1.000, 0.420, 0.663, 0.263, 1.000, 0.420, 0.663, 0.263, 1.000, 0.345, 0.596, 0.188, 1.000, 0.345, 0.235, 0.188, 1.000, 0.388, 0.392, 0.231, 1.000, 0.345, 0.235, 0.188, 1.000, 0.345, 0.235, 0.188, 1.000, 0.408, 0.659, 0.251, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.420, 0.580, 0.251, 1.000, 0.314, 0.267, 0.125, 1.000, 0.471, 0.737, 0.314, 1.000, 0.314, 0.267, 0.125, 1.000, 0.376, 0.373, 0.176, 1.000, 0.376, 0.235, 0.157, 1.000, 0.376, 0.235, 0.157, 1.000, 0.376, 0.373, 0.176, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.345, 0.235, 0.157, 1.000, 0.451, 0.329, 0.231, 1.000, 0.659, 0.518, 0.376, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.533, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.596, 0.784, 0.408, 1.000, 0.282, 0.565, 0.125, 1.000, 0.388, 0.639, 0.220, 1.000, 0.490, 0.710, 0.314, 1.000, 0.565, 0.753, 0.376, 1.000, 0.345, 0.612, 0.188, 1.000, 0.420, 0.659, 0.251, 1.000, 0.420, 0.659, 0.251, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.125, 1.000, 0.553, 0.424, 0.314, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.125, 1.000, 0.553, 0.424, 0.314, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.576, 0.424, 0.302, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.482, 0.710, 0.325, 1.000, 0.482, 0.710, 0.325, 1.000, 0.376, 0.627, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.482, 0.710, 0.325, 1.000, 0.482, 0.710, 0.325, 1.000, 0.482, 0.710, 0.325, 1.000, 0.388, 0.639, 0.220, 1.000, 0.490, 0.710, 0.314, 1.000, 0.388, 0.639, 0.220, 1.000, 0.388, 0.639, 0.220, 1.000, 0.345, 0.612, 0.188, 1.000, 0.420, 0.659, 0.251, 1.000, 0.420, 0.659, 0.251, 1.000, 0.490, 0.706, 0.314, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.451, 0.329, 0.220, 1.000, 0.553, 0.424, 0.314, 1.000, 0.345, 0.235, 0.125, 1.000, 0.345, 0.235, 0.125, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.451, 0.329, 0.220, 1.000, 0.553, 0.424, 0.314, 1.000, 0.345, 0.235, 0.125, 1.000, 0.345, 0.235, 0.125, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.376, 0.627, 0.220, 1.000, 0.482, 0.710, 0.325, 1.000, 0.533, 0.753, 0.376, 1.000, 0.427, 0.671, 0.271, 1.000, 0.427, 0.671, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.427, 0.671, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.388, 0.639, 0.220, 1.000, 0.388, 0.639, 0.220, 1.000, 0.596, 0.784, 0.408, 1.000, 0.596, 0.784, 0.408, 1.000, 0.420, 0.659, 0.251, 1.000, 0.565, 0.753, 0.376, 1.000, 0.490, 0.706, 0.314, 1.000, 0.420, 0.659, 0.251, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.659, 0.518, 0.408, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.659, 0.518, 0.408, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.690, 0.518, 0.376, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.659, 0.518, 0.408, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.659, 0.518, 0.408, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.690, 0.518, 0.376, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.427, 0.671, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.482, 0.710, 0.325, 1.000, 0.427, 0.671, 0.271, 1.000, 0.427, 0.671, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.533, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.490, 0.710, 0.314, 1.000, 0.596, 0.784, 0.408, 1.000, 0.388, 0.639, 0.220, 1.000, 0.388, 0.639, 0.220, 1.000, 0.420, 0.659, 0.251, 1.000, 0.490, 0.706, 0.314, 1.000, 0.345, 0.612, 0.188, 1.000, 0.565, 0.753, 0.376, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.553, 0.424, 0.314, 1.000, 0.553, 0.424, 0.314, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.576, 0.424, 0.302, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.553, 0.424, 0.314, 1.000, 0.553, 0.424, 0.314, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.576, 0.424, 0.302, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.408, 0.643, 0.220, 1.000, 0.482, 0.694, 0.294, 1.000, 0.627, 0.800, 0.439, 1.000, 0.553, 0.749, 0.365, 1.000, 0.565, 0.769, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.565, 0.769, 0.376, 1.000, 0.502, 0.722, 0.325, 1.000, 0.533, 0.769, 0.376, 1.000, 0.533, 0.769, 0.376, 1.000, 0.345, 0.612, 0.188, 1.000, 0.439, 0.690, 0.282, 1.000, 0.376, 0.627, 0.220, 1.000, 0.439, 0.675, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.451, 0.329, 0.231, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.231, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.451, 0.329, 0.231, 1.000, 0.482, 0.694, 0.294, 1.000, 0.408, 0.643, 0.220, 1.000, 0.627, 0.800, 0.439, 1.000, 0.408, 0.643, 0.220, 1.000, 0.439, 0.675, 0.271, 1.000, 0.439, 0.675, 0.271, 1.000, 0.565, 0.769, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.345, 0.612, 0.188, 1.000, 0.439, 0.690, 0.282, 1.000, 0.439, 0.690, 0.282, 1.000, 0.533, 0.769, 0.376, 1.000, 0.439, 0.675, 0.271, 1.000, 0.565, 0.769, 0.376, 1.000, 0.439, 0.675, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.659, 0.518, 0.376, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.459, 0.329, 0.231, 1.000, 0.659, 0.518, 0.376, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.482, 0.694, 0.294, 1.000, 0.482, 0.694, 0.294, 1.000, 0.482, 0.694, 0.294, 1.000, 0.553, 0.749, 0.365, 1.000, 0.376, 0.627, 0.220, 1.000, 0.565, 0.769, 0.376, 1.000, 0.439, 0.675, 0.271, 1.000, 0.439, 0.675, 0.271, 1.000, 0.627, 0.847, 0.471, 1.000, 0.345, 0.612, 0.188, 1.000, 0.533, 0.769, 0.376, 1.000, 0.345, 0.612, 0.188, 1.000, 0.439, 0.675, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.439, 0.675, 0.271, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.376, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.553, 0.424, 0.302, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.376, 1.000, 0.690, 0.518, 0.376, 1.000, 0.459, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.553, 0.424, 0.302, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.408, 0.643, 0.220, 1.000, 0.553, 0.749, 0.365, 1.000, 0.408, 0.643, 0.220, 1.000, 0.553, 0.749, 0.365, 1.000, 0.502, 0.722, 0.325, 1.000, 0.376, 0.627, 0.220, 1.000, 0.439, 0.675, 0.271, 1.000, 0.439, 0.675, 0.271, 1.000, 0.439, 0.690, 0.282, 1.000, 0.439, 0.690, 0.282, 1.000, 0.439, 0.690, 0.282, 1.000, 0.345, 0.612, 0.188, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.439, 0.675, 0.271, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.553, 0.424, 0.302, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.576, 0.424, 0.302, 1.000, 0.459, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.553, 0.424, 0.302, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.596, 0.800, 0.408, 1.000, 0.502, 0.725, 0.325, 1.000, 0.408, 0.655, 0.239, 1.000, 0.408, 0.655, 0.239, 1.000, 0.459, 0.694, 0.282, 1.000, 0.459, 0.694, 0.282, 1.000, 0.376, 0.627, 0.188, 1.000, 0.376, 0.627, 0.188, 1.000, 0.251, 0.518, 0.094, 1.000, 0.502, 0.725, 0.325, 1.000, 0.376, 0.624, 0.208, 1.000, 0.376, 0.624, 0.208, 1.000, 0.502, 0.710, 0.325, 1.000, 0.565, 0.753, 0.376, 1.000, 0.376, 0.627, 0.220, 1.000, 0.376, 0.627, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.553, 0.424, 0.302, 1.000, 0.553, 0.424, 0.302, 1.000, 0.659, 0.518, 0.376, 1.000, 0.451, 0.329, 0.231, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.553, 0.424, 0.314, 1.000, 0.553, 0.424, 0.314, 1.000, 0.659, 0.518, 0.408, 1.000, 0.451, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.690, 0.518, 0.345, 1.000, 0.596, 0.800, 0.408, 1.000, 0.502, 0.725, 0.325, 1.000, 0.314, 0.580, 0.157, 1.000, 0.314, 0.580, 0.157, 1.000, 0.376, 0.627, 0.188, 1.000, 0.376, 0.627, 0.188, 1.000, 0.376, 0.627, 0.188, 1.000, 0.627, 0.831, 0.471, 1.000, 0.502, 0.725, 0.325, 1.000, 0.627, 0.831, 0.439, 1.000, 0.502, 0.725, 0.325, 1.000, 0.502, 0.725, 0.325, 1.000, 0.502, 0.710, 0.325, 1.000, 0.376, 0.627, 0.220, 1.000, 0.565, 0.753, 0.376, 1.000, 0.565, 0.753, 0.376, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.451, 0.329, 0.231, 1.000, 0.553, 0.424, 0.302, 1.000, 0.553, 0.424, 0.302, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.451, 0.329, 0.220, 1.000, 0.553, 0.424, 0.314, 1.000, 0.553, 0.424, 0.314, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.345, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.502, 0.725, 0.325, 1.000, 0.502, 0.725, 0.325, 1.000, 0.408, 0.655, 0.239, 1.000, 0.314, 0.580, 0.157, 1.000, 0.545, 0.765, 0.376, 1.000, 0.545, 0.765, 0.376, 1.000, 0.459, 0.694, 0.282, 1.000, 0.459, 0.694, 0.282, 1.000, 0.376, 0.624, 0.208, 1.000, 0.502, 0.725, 0.325, 1.000, 0.502, 0.725, 0.325, 1.000, 0.376, 0.624, 0.208, 1.000, 0.565, 0.753, 0.376, 1.000, 0.502, 0.710, 0.325, 1.000, 0.439, 0.671, 0.271, 1.000, 0.502, 0.710, 0.325, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.345, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.451, 0.329, 0.231, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.690, 0.518, 0.345, 1.000, 0.451, 0.329, 0.220, 1.000, 0.345, 0.235, 0.125, 1.000, 0.451, 0.329, 0.220, 1.000, 0.345, 0.235, 0.125, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.408, 0.655, 0.239, 1.000, 0.502, 0.725, 0.325, 1.000, 0.408, 0.655, 0.239, 1.000, 0.314, 0.580, 0.157, 1.000, 0.545, 0.765, 0.376, 1.000, 0.459, 0.694, 0.282, 1.000, 0.459, 0.694, 0.282, 1.000, 0.627, 0.831, 0.471, 1.000, 0.376, 0.624, 0.208, 1.000, 0.627, 0.831, 0.439, 1.000, 0.376, 0.624, 0.208, 1.000, 0.376, 0.624, 0.208, 1.000, 0.376, 0.627, 0.220, 1.000, 0.439, 0.671, 0.271, 1.000, 0.376, 0.627, 0.220, 1.000, 0.502, 0.710, 0.325, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.553, 0.424, 0.302, 1.000, 0.451, 0.329, 0.231, 1.000, 0.659, 0.518, 0.376, 1.000, 0.553, 0.424, 0.302, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.690, 0.518, 0.345, 1.000, 0.576, 0.424, 0.282, 1.000, 0.553, 0.424, 0.314, 1.000, 0.451, 0.329, 0.220, 1.000, 0.659, 0.518, 0.408, 1.000, 0.553, 0.424, 0.314, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.459, 0.329, 0.220, 1.000, 0.576, 0.424, 0.282, 1.000, 0.576, 0.424, 0.282, 1.000, 0.459, 0.329, 0.220, 1.000, 0.345, 0.235, 0.157, 1.000 ];
		var tex = [];
		gl.genTextures( 1, tex );
		gl.bindTexture( GL.TEXTURE_2D, tex[0] );
		gl.texImage2D( GL.TEXTURE_2D, 48, 16, GL.FLOAT, grassTexture );
		
		var t = 0;
		var data = [];
		while ( true )
		{
			t += 0.1;
			
			// Draw scene
			gl.clear( GL.COLOR_BUFFER_BIT | GL.DEPTH_BUFFER_BIT );

			gl.matrixMode( GL.MODELVIEW );
			gl.loadIdentity();
			gl.lookAt( 2, 2, 2, 0, 0, 0, 0, 0, 1 );
			gl.rotatef( t/2, 0, 0, 1 );
			gl.translatef( -0.5, -0.5, -0.2 );

			gl.matrixMode( GL.PROJECTION );
			gl.loadIdentity();
			gl.perspective( 90*h/w, w/h, 1, 4 );

			gl.begin( GL.QUADS );
				gl.color3f( 1, 1, 1 );

				// Top
				gl.texCoord2f( 0.0, 1.0 );
				gl.vertex3f( 0, 1, 1 );
				gl.texCoord2f( 0.33, 1.0 );
				gl.vertex3f( 1, 1, 1 );
				gl.texCoord2f( 0.33, 0.0 );
				gl.vertex3f( 1, 0, 1 );
				gl.texCoord2f( 0.0, 0.0 );
				gl.vertex3f( 0, 0, 1 );

				// Bottom
				gl.texCoord2f( 0.66, 1.0 );
				gl.vertex3f( 0, 1, 0 );
				gl.texCoord2f( 1.0, 1.0 );
				gl.vertex3f( 1, 1, 0 );
				gl.texCoord2f( 1.0, 0.0 );
				gl.vertex3f( 1, 0, 0 );
				gl.texCoord2f( 0.66, 0.0 );
				gl.vertex3f( 0, 0, 0 );

				// Front
				gl.texCoord2f( 0.34, 0.0 );
				gl.vertex3f( 0, 0, 1 );
				gl.texCoord2f( 0.66, 0.0 );
				gl.vertex3f( 1, 0, 1 );
				gl.texCoord2f( 0.66, 0.99 );
				gl.vertex3f( 1, 0, 0 );
				gl.texCoord2f( 0.34, 0.99 );
				gl.vertex3f( 0, 0, 0 );

				// Back
				gl.texCoord2f( 0.34, 0.0 );
				gl.vertex3f( 0, 1, 1 );
				gl.texCoord2f( 0.66, 0.0 );
				gl.vertex3f( 1, 1, 1 );
				gl.texCoord2f( 0.66, 0.99 );
				gl.vertex3f( 1, 1, 0 );
				gl.texCoord2f( 0.34, 0.99 );
				gl.vertex3f( 0, 1, 0 );

				// Left side
				gl.texCoord2f( 0.34, 0.0 );
				gl.vertex3f( 0, 0, 1 );
				gl.texCoord2f( 0.66, 0.0 );
				gl.vertex3f( 0, 1, 1 );
				gl.texCoord2f( 0.66, 0.99 );
				gl.vertex3f( 0, 1, 0 );
				gl.texCoord2f( 0.34, 0.99 );
				gl.vertex3f( 0, 0, 0 );

				// Right side
				gl.texCoord2f( 0.34, 0.0 );
				gl.vertex3f( 1, 0, 1 );
				gl.texCoord2f( 0.66, 0.0 );
				gl.vertex3f( 1, 1, 1 );
				gl.texCoord2f( 0.66, 0.99 );
				gl.vertex3f( 1, 1, 0 );
				gl.texCoord2f( 0.34, 0.99 );
				gl.vertex3f( 1, 0, 0 );
			gl.end();
			
			// Display
			gl.readPixels( 0, 0, 320, 200, GL.RGB, GL.UNSIGNED_BYTE_2_3_3, data );
			OS.ioctl( vga, "drawPixels", data );
		}
	} );
} );
